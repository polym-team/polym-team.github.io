---
import Layout from '../layouts/Layout.astro';
import yaml from 'js-yaml';
import fs from 'node:fs';
import path from 'node:path';

// YAML 데이터 로드
const teamDataPath = path.join(process.cwd(), 'content/team.yaml');
const teamData = yaml.load(fs.readFileSync(teamDataPath, 'utf8')) as any;

const { team, values, works, apps, members, projects, contact } = teamData;

// 플랫폼 아이콘 매핑
const platformIcons: Record<string, string> = {
  web: 'M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9',
  ios: 'M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11',
  android: 'M17.6 9.48l1.84-3.18c.16-.31.04-.69-.26-.85-.29-.15-.65-.06-.83.22l-1.88 3.24c-1.4-.59-2.94-.92-4.52-.92-1.56 0-3.08.33-4.48.91L5.6 5.67c-.19-.29-.58-.38-.87-.2-.28.18-.37.54-.22.83L6.4 9.48C3.3 11.25 1.28 14.44 1 18h22c-.28-3.56-2.3-6.75-5.4-8.52M7 15.25c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25m10 0c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25',
  'cross-platform': 'M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z'
};
---

<Layout title={`${team.name} - ${team.tagline}`}>
  <!-- Hero Section -->
  <section class="min-h-[90vh] flex items-center justify-center relative overflow-hidden">
    <!-- Background gradient -->
    <div class="absolute inset-0 bg-gradient-to-br from-[var(--color-accent)]/5 via-transparent to-[var(--color-accent)]/10"></div>

    <!-- Grid pattern -->
    <div
      class="absolute inset-0 opacity-[0.03]"
      style="background-image: linear-gradient(var(--color-text) 1px, transparent 1px), linear-gradient(90deg, var(--color-text) 1px, transparent 1px); background-size: 60px 60px;"
    >
    </div>

    <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="animate-fade-in">
        <!-- <img src="/logo/logo_polymorph_mint.png" alt={team.name} class="mx-auto mb-8 drop-shadow-lg" /> -->
        <h1 class="text-4xl sm:text-5xl lg:text-7xl font-bold tracking-tight mb-4">
          <span class="bg-gradient-to-r from-[var(--color-accent)] to-[var(--color-text)] bg-clip-text text-transparent">
            {team.name}
          </span>
        </h1>
        <p class="text-xl sm:text-2xl text-[var(--color-muted)] mb-6">{team.tagline}</p>
        <p class="max-w-2xl mx-auto text-[var(--color-muted)] leading-relaxed mb-8">
          {team.description}
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="#contact" class="px-8 py-3 bg-[var(--color-accent)] text-white font-medium rounded-lg hover:opacity-90 transition-opacity"> Contact Us </a>
          <a href="#projects" class="px-8 py-3 border border-[var(--color-line)] rounded-lg hover:border-[var(--color-accent)] transition-colors">
            View Projects
          </a>
        </div>
      </div>
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce">
      <svg class="w-6 h-6 text-[var(--color-muted)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
      </svg>
    </div>
  </section>

  <!-- Values Section -->
  <section id="about" class="py-20 sm:py-32 bg-[var(--color-card)]">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Our Values</span>
        <h2 class="text-3xl sm:text-4xl font-bold mt-2">Why Choose Us</h2>
      </div>

      <div class="grid md:grid-cols-3 gap-8">
        {
          values.map((value: any, index: number) => (
            <div class="group p-8 rounded-2xl bg-[var(--color-bg)] border border-[var(--color-line)] hover:border-[var(--color-accent)] transition-all duration-300 hover:-translate-y-1">
              <div class="w-12 h-12 rounded-xl bg-[var(--color-accent)]/10 flex items-center justify-center mb-6 group-hover:bg-[var(--color-accent)]/20 transition-colors">
                <span class="text-[var(--color-accent)] font-bold text-lg">0{index + 1}</span>
              </div>
              <h3 class="text-xl font-semibold mb-3">{value.title}</h3>
              <p class="text-[var(--color-muted)] leading-relaxed">{value.description}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Services Section -->
  <section id="services" class="py-20 sm:py-32">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Services</span>
        <h2 class="text-3xl sm:text-4xl font-bold mt-2">What We Do</h2>
      </div>

      <div class="grid md:grid-cols-3 gap-8">
        {
          works.map((work: any) => (
            <div class="relative p-8 rounded-2xl border border-[var(--color-line)] hover:border-[var(--color-accent)] transition-all duration-300 group">
              <div class="absolute top-0 right-0 w-24 h-24 bg-gradient-to-br from-[var(--color-accent)]/10 to-transparent rounded-bl-[100px] rounded-tr-2xl" />
              <h3 class="text-xl font-semibold mb-3 relative z-10">{work.title}</h3>
              <p class="text-[var(--color-muted)] leading-relaxed relative z-10">{work.description}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Apps Section -->
  {apps && apps.length > 0 && (
    <section id="apps" class="py-20 sm:py-32 bg-[var(--color-card)]">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Products</span>
          <h2 class="text-3xl sm:text-4xl font-bold mt-2">Our Apps</h2>
        </div>

        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {apps.map((app: any) => (
            <a
              href={app.url}
              target="_blank"
              rel="noopener noreferrer"
              class="group flex items-center gap-4 p-6 rounded-2xl bg-[var(--color-bg)] border border-[var(--color-line)] hover:border-[var(--color-accent)] transition-all duration-300 hover:-translate-y-1"
            >
              {app.icon ? (
                <img src={app.icon} alt={app.name} class="w-16 h-16 rounded-xl object-cover flex-shrink-0" />
              ) : (
                <div class="w-16 h-16 rounded-xl bg-[var(--color-accent)]/10 flex items-center justify-center flex-shrink-0">
                  <svg class="w-8 h-8 text-[var(--color-accent)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d={platformIcons[app.platform] || platformIcons.web} />
                  </svg>
                </div>
              )}
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2">
                  <h3 class="font-semibold truncate">{app.name}</h3>
                  <svg class="w-4 h-4 text-[var(--color-muted)] group-hover:text-[var(--color-accent)] transition-colors flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                  </svg>
                </div>
                <p class="text-sm text-[var(--color-muted)] mt-1 line-clamp-2">{app.description}</p>
                {app.history && app.history.length > 0 && (
                  <p class="text-xs text-[var(--color-muted)] mt-2 opacity-75">{app.history[app.history.length - 1]}</p>
                )}
                <div class="mt-2">
                  {(Array.isArray(app.platform) ? app.platform : [app.platform]).map((p: string) => (
                    <span class="inline-block mr-1 text-xs px-2 py-0.5 rounded-full bg-[var(--color-accent)]/10 text-[var(--color-accent)] capitalize">{p}</span>
                  ))}
                </div>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Projects Section -->
  <section id="projects" class="py-20 sm:py-32">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Portfolio</span>
        <h2 class="text-3xl sm:text-4xl font-bold mt-2">Our Projects</h2>
      </div>

      <div class="space-y-8">
        {
          projects.map((project: any, index: number) => (
            <div class="group p-8 rounded-2xl bg-[var(--color-card)] border border-[var(--color-line)] hover:border-[var(--color-accent)] transition-all duration-300">
              <div class="flex flex-col lg:flex-row lg:items-start gap-6">
                <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-[var(--color-accent)]/10 flex items-center justify-center">
                  <span class="text-[var(--color-accent)] font-bold">0{index + 1}</span>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold mb-4">{project.name}</h3>
                  <ul class="space-y-2 mb-6">
                    {project.description.map((desc: string) => (
                      <li class="flex items-start gap-3 text-[var(--color-muted)]">
                        <svg class="w-5 h-5 text-[var(--color-accent)] flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span>{desc}</span>
                      </li>
                    ))}
                  </ul>
                  <div class="flex flex-wrap gap-2">
                    {project.techStack.map((tech: string) => (
                      <span class="px-3 py-1 text-xs font-medium bg-[var(--color-accent)]/10 text-[var(--color-accent)] rounded-full">{tech}</span>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Team Section -->
  <section class="py-20 sm:py-32 bg-[var(--color-card)]">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Team</span>
        <h2 class="text-3xl sm:text-4xl font-bold mt-2">Meet Our Team</h2>
      </div>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center">
        {
          members.map((member: any) => (
            <div class="w-full max-w-sm p-6 rounded-2xl bg-[var(--color-bg)] border border-[var(--color-line)] hover:border-[var(--color-accent)] transition-all duration-300 text-center">
              {member.avatar ? (
                <img src={member.avatar} alt={member.name} class="w-20 h-20 rounded-full mx-auto mb-4 object-cover border-2 border-[var(--color-accent)]" />
              ) : (
                <div class="w-20 h-20 rounded-full mx-auto mb-4 bg-[var(--color-accent)]/10 flex items-center justify-center">
                  <span class="text-2xl font-bold text-[var(--color-accent)]">{member.name.charAt(0)}</span>
                </div>
              )}
              <h3 class="text-lg font-semibold mb-1">{member.name}</h3>
              <p class="text-sm text-[var(--color-accent)] mb-2">{member.role}</p>
              <p class="text-sm text-[var(--color-muted)]">{member.bio}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="py-20 sm:py-32">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-2xl mx-auto text-center">
        <span class="text-[var(--color-accent)] text-sm font-medium tracking-wider uppercase">Contact</span>
        <h2 class="text-3xl sm:text-4xl font-bold mt-2 mb-6">Let's Work Together</h2>
        <p class="text-[var(--color-muted)] mb-8">프로젝트에 대해 상담하고 싶으시다면 언제든지 연락주세요.</p>

        <div class="p-8 rounded-2xl bg-[var(--color-card)] border border-[var(--color-line)]">
          <div class="flex items-center justify-center gap-3 mb-6">
            <svg class="w-6 h-6 text-[var(--color-accent)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            <span class="text-lg">Email</span>
          </div>
          <a
            href={`mailto:${contact.email}`}
            class="inline-block px-8 py-4 text-lg font-medium bg-[var(--color-accent)] text-white rounded-xl hover:opacity-90 transition-opacity"
          >
            {contact.email}
          </a>
        </div>

        <p class="mt-8 text-sm text-[var(--color-muted)]">
          Since {team.founded}
        </p>
      </div>
    </div>
  </section>
</Layout>
